<%= render "nav" %>

<% if user_signed_in? %>
  <% if current_user.user_role.downcase == "manager" %>
    <%if @products.size == 0%>
      <h2> No Products Added Yet. Add Some ! 
      <%= link_to "Add", new_restaurant_product_path %></h2>
    <%else%>



      <p id="notice"><%= notice %></p>

      <h1 style = "margin-top: 4rem;">Products</h1>

      <table>
        <thead>
          <tr>
            <th>Image</th>
            <th>Name</th>
            <th>Price</th>
            <th>Veg nveg</th>
            <th>Category</th>
            <th>Portion</th>
            <th colspan="3"></th>
          </tr>
        </thead>

        <tbody>
          <% @products.each do |product| %>
            <tr>
              
              <td><%= link_to(image_tag(product.image.thumb.url, alt: 'Image'), restaurant_product ,target: '_blank') if product.image? %></td>
              <td><%= product.name %></td>
              <td><%= product.price %></td>
              <td><%= product.veg_nveg %></td>
              <td><%= product.category %></td>
              <td><%= product.portion %></td>
              <td><%= link_to 'Show', restaurant_product_path(product.restaurant_id, product) %></td>
              <td><%= link_to 'Edit', edit_restaurant_product_path(product.restaurant_id, product) %>
              <td><%= link_to 'Delete', restaurant_products_path(@restaurant), method: :delete, data: { confirm: 'Are you sure?' }, :remote => true, :class => 'delete_product' %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
      <br>
      <%= link_to 'Add Product', new_restaurant_product_path %> | 
      <%= link_to 'Back to Restaurants', restaurants_path %>
    <% end %>
  <% elsif current_user.user_role.downcase == "customer" %>
    <%if @products.size == 0%>
      <h2> No Products Added Yet.
    <%else%>

      <p id="notice"><%= notice %></p>

      <h1 style = "margin-top: 4rem;">Products</h1>

      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Price</th>
            <th>Veg nveg</th>
            <th>Category</th>
            <th>Portion</th>

            <th colspan="3"></th>
          </tr>
        </thead>

        <tbody>
          <% @products.each do |product| %>
            <tr>
              <td><%= link_to(image_tag(product.image.thumb.url, alt: 'Image'), restaurant_product ,target: '_blank') if product.image? %></td>
              <td><%= product.name %></td>
              <td><%= product.price %></td>
              <td><%= product.veg_nveg %></td>
              <td><%= product.category %></td>
              <td><%= product.portion %></td>

              <td><%= link_to 'Show', restaurant_product_path(product.restaurant_id, product) %></td>
              <td>
                <%= form_for @line_item, remote: true do |f|%>
                <%= f.hidden_field :product_id, :value => product.id %>
                <%= f.number_field :quantity, :value => 1, :min => 1 %>
                <%= f.submit "Add to Cart" %>
                <% end %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
      <br>
      <div id = "cart">
        <%= render 'carts/cart' %>
      </div>
    <% end %>
  <% end %>
<% end %>




